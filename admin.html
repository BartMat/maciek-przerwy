<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel</title>
    <style>
    body {
      background: #181c22;
      color: #f3f3f3;
      min-height: 100vh;
      margin: 0;
      font-family: 'Segoe UI', 'Roboto', Arial, sans-serif;
    }
    .header {
      width: 100%;
      background: #23272f;
      padding: 1.5rem 2rem 1rem 2rem;
      box-sizing: border-box;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid #222a;
    }
    .title {
      font-size: 2.2rem;
      font-weight: 700;
      color: #00c6ff;
      letter-spacing: 1px;
      margin: 0;
    }
    .content {
      max-width: 700px;
      margin: 2em auto;
      background: #23272f;
      border-radius: 18px;
      box-shadow: 0 8px 32px 0 #00000040;
      padding: 2.5em 2em;
      min-height: 200px;
    }
    a.button {
      display: inline-block;
      background: #00c6ff;
      color: #181c22;
      padding: 0.7em 2em;
      border-radius: 10px;
      text-decoration: none;
      font-weight: 600;
      font-size: 1.1em;
      margin-top: 2em;
      transition: background 0.2s, color 0.2s;
    }
    a.button:hover {
      background: #0099cc;
      color: #fff;
    }
    /* Center the slots 1-5 horizontally in the time slots table */
    #time-slot-table-body tr {
      text-align: center;
    }
    #time-slot-table-body td {
      text-align: center;
      vertical-align: middle;
    }
    #time-slot-table-body input[type="number"] {
      display: inline-block;
      margin-left: auto;
      margin-right: auto;
      text-align: center;
    }

    /* Center the dual service slots 1-5 for TNT and FedEx */
    .dual-service-slots {
      display: flex;
      justify-content: center;
      gap: 2.5em;
      margin: 2em 0 1.5em 0;
    }
    .dual-service-slots .service {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: #23272f;
      border-radius: 14px;
      border: 1.5px solid #00c6ff;
      padding: 1.2em 2em 1.5em 2em;
      min-width: 180px;
      box-shadow: 0 4px 16px 0 #00000030;
    }
    .dual-service-slots .service h3 {
      color: #00c6ff;
      margin-bottom: 1em;
      text-align: center;
    }
    .dual-service-slots .slot-inputs {
      display: flex;
      flex-direction: row;
      gap: 0.7em;
      justify-content: center;
      margin-bottom: 0.5em;
    }
    .dual-service-slots input[type="number"] {
      width: 38px;
      text-align: center;
      border-radius: 8px;
      border: 2px solid #00c6ff;
      background: #2d3542;
      color: #fff;
      font-size: 1.1em;
      padding: 0.3em 0.5em;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="title">Admin Panel</div>
  </div>
  <div class="content" id="admin-login">
    <h2>Admin Login</h2>
    <p>Please enter the admin password to access the full admin panel.</p>
  <input type="password" id="admin-password" placeholder="Password" style="padding:0.5em 1em; border-radius:8px; border:2px solid #00c6ff; border-top:4px solid #00c6ff; background:#23272f; color:#fff; font-size:1.1em; margin-bottom:1em; width:70%; text-align:center;">
    <button id="admin-login-btn" style="background:#00c6ff;color:#181c22;padding:0.5em 1.5em;border-radius:10px;font-weight:600;font-size:1em;cursor:pointer;">Login</button>
    <div id="admin-login-error" style="color:#ff4d4d; margin-top:1em; display:none;">Incorrect password. Try again.</div>
  <a href="index.html" class="button">Back to Main Page</a>
  </div>
  <div class="content" id="admin-content" style="display:none;">
    <h2>Welcome to the Admin Panel</h2>
    <p>This page is reserved for administrative actions.</p>
    <fieldset style="margin:2em 0 2em 0;padding:1.5em 1em 1em 1em;border-radius:12px;border:1px solid #00c6ff;max-width:600px;">
      <legend style="color:#00c6ff;font-weight:600;font-size:1.1em;">Set Max Slots by Time (30 min intervals from 08:00)</legend>
      <div style="overflow-x:auto;">
        <table style="width:100%;border-collapse:collapse;">
          <thead>
            <tr style="background:#23272f;color:#fff;">
              <th style="padding:0.5em 1em;text-align:center;">Time CET</th>
              <th style="padding:0.5em 1em;text-align:center;">TNT</th>
              <th style="padding:0.5em 1em;text-align:center;">FedEx</th>
            </tr>
          </thead>
          <tbody id="time-slot-table-body">
            <!-- Rows will be generated by JS -->
          </tbody>
        </table>
      </div>
      <div style="display:flex; justify-content:flex-end; align-items:center; margin-top:1em; gap:0.7em;">
        <span id="time-slots-saved" style="color:#00c6ff;display:none;">Saved!</span>
        <button id="apply-time-slots" style="background:#00c6ff;color:#181c22;padding:0.5em 1.5em;border-radius:10px;font-weight:600;font-size:1em;cursor:pointer;">Apply</button>
      </div>
    </fieldset>

    <!-- Additional Slots Approved by WFM -->
    <fieldset style="margin:2em 0 2em 0;padding:1.5em 1em 1em 1em;border-radius:12px;border:1px solid #00c6ff;max-width:600px;">
      <legend style="color:#00c6ff;font-weight:600;font-size:1.1em;">Additional Slots Approved by WFM</legend>
      <div style="display:flex; gap:2em; align-items:center; justify-content:center; margin-bottom:1em;">
        <div style="display:flex; flex-direction:column; align-items:center;">
          <label for="wfm-tnt" style="color:#00c6ff; font-weight:600; margin-bottom:0.5em;">TNT</label>
          <input type="number" id="wfm-tnt" min="0" max="99" style="width:80px;padding:0.5em 1em;border-radius:8px;border:2px solid #00c6ff;border-top:4px solid #00c6ff;background:#23272f;color:#fff;font-size:1.1em;text-align:center;">
        </div>
        <div style="display:flex; flex-direction:column; align-items:center;">
          <label for="wfm-fdx" style="color:#00c6ff; font-weight:600; margin-bottom:0.5em;">FedEx</label>
          <input type="number" id="wfm-fdx" min="0" max="99" style="width:80px;padding:0.5em 1em;border-radius:8px;border:2px solid #00c6ff;border-top:4px solid #00c6ff;background:#23272f;color:#fff;font-size:1.1em;text-align:center;">
        </div>
      </div>
      <div style="display:flex; justify-content:flex-end; align-items:center; margin-top:1em; gap:0.7em;">
        <span id="wfm-slots-saved" style="color:#00c6ff;display:none;">Saved!</span>
        <button id="apply-wfm-slots" style="background:#00c6ff;color:#181c22;padding:0.5em 1.5em;border-radius:10px;font-weight:600;font-size:1em;cursor:pointer;">Apply</button>
      </div>
    </fieldset>
    <fieldset style="margin:2em 0 2em 0;padding:1.5em 1em 1em 1em;border-radius:12px;border:1px solid #00c6ff;max-width:600px;">
      <legend style="color:#00c6ff;font-weight:600;font-size:1.1em;">Set notes</legend>
  <textarea id="admin-notes" rows="3" style="width:60%;min-width:220px;max-width:350px;border-radius:8px;padding:0.5em 1em;font-size:1.1em;border:2px solid #00c6ff;border-top:4px solid #00c6ff;background:#23272f;color:#fff;text-align:center;"></textarea>
      <div style="display:flex; justify-content:flex-end; align-items:center; margin-top:1em; gap:0.7em;">
        <span id="admin-notes-saved" style="color:#00c6ff;display:none;">Saved!</span>
        <button id="apply-admin-notes" style="background:#00c6ff;color:#181c22;padding:0.5em 1.5em;border-radius:10px;font-weight:600;font-size:1em;cursor:pointer;">Apply</button>
      </div>
    </fieldset>
    <fieldset style="margin:2em 0 2em 0;padding:1.5em 1em 1em 1em;border-radius:12px;border:1px solid #00c6ff;max-width:600px;">
      <legend style="color:#00c6ff;font-weight:600;font-size:1.1em;">Set Admin Password</legend>
  <input type="password" id="set-admin-password" placeholder="New password" style="width:60%;min-width:180px;max-width:300px;border-radius:8px;padding:0.5em 1em;font-size:1.1em;border:2px solid #00c6ff;border-top:4px solid #00c6ff;background:#23272f;color:#fff;text-align:center;">
      <button id="apply-admin-password" style="background:#00c6ff;color:#181c22;padding:0.5em 1.5em;border-radius:10px;font-weight:600;font-size:1em;cursor:pointer;margin-left:1em;">Set Password</button>
      <span id="admin-password-saved" style="color:#00c6ff;display:none;margin-left:1em;">Saved!</span>
    </fieldset>
    <a href="index.html" class="button">Back to Main Page</a>
  </div>
  <script>
    // Set default admin password hash if not set
    if (!localStorage.getItem('admin-password-hash')) {
      localStorage.setItem('admin-password-hash', '240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9');
    }
    // Admin notes logic
    function loadAdminNotes() {
      const val = localStorage.getItem('admin-notes') || '';
      document.getElementById('admin-notes').value = val;
    }
    function saveAdminNotes() {
      const val = document.getElementById('admin-notes').value;
      localStorage.setItem('admin-notes', val);
      document.getElementById('admin-notes-saved').style.display = 'inline';
      setTimeout(() => {
        document.getElementById('admin-notes-saved').style.display = 'none';
      }, 1200);
    }
    document.getElementById('apply-admin-notes').addEventListener('click', function() {
      saveAdminNotes();
      // Notify other tabs to update the orange box immediately
      window.dispatchEvent(new Event('admin-notes-updated'));
    });
    loadAdminNotes();

  // Time CET slots admin logic
    function generateTimeIntervals(startHour, endHour, intervalMins) {
      const intervals = [];
      let current = new Date(0,0,0,startHour,0,0,0);
      const end = new Date(0,0,0,endHour,0,0,0);
      while (current < end) {
        let next = new Date(current.getTime() + intervalMins*60000);
        let label = current.toTimeString().slice(0,5) + ' - ' + next.toTimeString().slice(0,5);
        intervals.push({
          key: current.getHours().toString().padStart(2,'0') + ':' + current.getMinutes().toString().padStart(2,'0'),
          label
        });
        current = next;
      }
      return intervals;
    }

    // Max Slots by Time
    function loadTimeSlots() {
      const tbody = document.getElementById('time-slot-table-body');
      tbody.innerHTML = '';
      const intervals = generateTimeIntervals(8, 18, 30);
      const saved = JSON.parse(localStorage.getItem('time-slots') || '{}');
      intervals.forEach(({key, label}) => {
        const tntVal = saved[key]?.tnt ?? '';
        const fdxVal = saved[key]?.fdx ?? '';
        const row = document.createElement('tr');
        row.innerHTML = `
          <td style="text-align:center;">${label}</td>
          <td style="text-align:center;"><input type="number" min="0" max="10" data-time="${key}" data-col="tnt" style="width:60px;padding:0.5em 1em;border-radius:8px;border:2px solid #00c6ff;border-top:4px solid #00c6ff;background:#23272f;color:#fff;font-size:1.1em;text-align:center;"></td>
          <td style="text-align:center;"><input type="number" min="0" max="10" data-time="${key}" data-col="fdx" style="width:60px;padding:0.5em 1em;border-radius:8px;border:2px solid #00c6ff;border-top:4px solid #00c6ff;background:#23272f;color:#fff;font-size:1.1em;text-align:center;"></td>
        `;
        row.querySelector('input[data-col="tnt"]').value = tntVal;
        row.querySelector('input[data-col="fdx"]').value = fdxVal;
        tbody.appendChild(row);
      });
    }
    function saveTimeSlots() {
      const inputs = document.querySelectorAll('#time-slot-table-body input[data-time]');
      const slots = {};
      inputs.forEach(input => {
        const time = input.getAttribute('data-time');
        const col = input.getAttribute('data-col');
        if (!slots[time]) slots[time] = {};
        slots[time][col] = input.value;
      });
      localStorage.setItem('time-slots', JSON.stringify(slots));
      document.getElementById('time-slots-saved').style.display = 'inline';
      setTimeout(() => {
        document.getElementById('time-slots-saved').style.display = 'none';
      }, 1200);
    }
    document.getElementById('apply-time-slots').addEventListener('click', saveTimeSlots);
    loadTimeSlots();

    // Additional Slots Approved by WFM (single value per TNT/FedEx)
    function loadWfmSlots() {
      const saved = JSON.parse(localStorage.getItem('wfm-slots') || '{}');
      document.getElementById('wfm-tnt').value = saved.tnt ?? '';
      document.getElementById('wfm-fdx').value = saved.fdx ?? '';
    }
    function saveWfmSlots() {
      const tnt = document.getElementById('wfm-tnt').value;
      const fdx = document.getElementById('wfm-fdx').value;
      localStorage.setItem('wfm-slots', JSON.stringify({ tnt, fdx }));
      // Force storage event for same-tab update
      window.dispatchEvent(new StorageEvent('storage', { key: 'wfm-slots', newValue: JSON.stringify({ tnt, fdx }) }));
      document.getElementById('wfm-slots-saved').style.display = 'inline';
      setTimeout(() => {
        document.getElementById('wfm-slots-saved').style.display = 'none';
      }, 1200);
    }
    document.getElementById('apply-wfm-slots').addEventListener('click', saveWfmSlots);
    loadWfmSlots();
  </script>
  <script>
    // Secure password logic using hash stored in localStorage
    async function hashPassword(pw) {
      const enc = new TextEncoder();
      const data = enc.encode(pw);
      const hash = await window.crypto.subtle.digest('SHA-256', data);
      return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, '0')).join('');
    }
    document.getElementById('admin-login-btn').onclick = async function() {
      const input = document.getElementById('admin-password').value;
      const storedHash = localStorage.getItem('admin-password-hash');
      if (!storedHash) {
        document.getElementById('admin-login-error').textContent = 'No admin password set.';
        document.getElementById('admin-login-error').style.display = 'block';
        return;
      }
      const inputHash = await hashPassword(input);
      if (inputHash === storedHash) {
        document.getElementById('admin-login').style.display = 'none';
        document.getElementById('admin-content').style.display = '';
      } else {
        document.getElementById('admin-login-error').textContent = 'Incorrect password. Try again.';
        document.getElementById('admin-login-error').style.display = 'block';
      }
    };
    document.getElementById('admin-password').addEventListener('keydown', function(e) {
      if (e.key === 'Enter') document.getElementById('admin-login-btn').click();
    });
    document.getElementById('apply-admin-password').onclick = async function() {
      const pw = document.getElementById('set-admin-password').value;
      if (!pw) return;
      const hash = await hashPassword(pw);
      localStorage.setItem('admin-password-hash', hash);
      document.getElementById('admin-password-saved').style.display = 'inline';
      setTimeout(() => {
        document.getElementById('admin-password-saved').style.display = 'none';
      }, 1200);
      document.getElementById('set-admin-password').value = '';
    };
  </script>
</body>
</html>
